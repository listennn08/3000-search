(this["webpackJsonp3000-search"]=this["webpackJsonp3000-search"]||[]).push([[0],{103:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),c=a(21),r=a.n(c),o=(a(74),a(26)),i=a(27),s=a(39),u=a(36),m=a(42),d=a(10),v=a(112),f=a(113),h=a(67),p=a(7),b=a(109),E=a(105),g=a(106),x=a(114),w=function(e){var t=e.options.map((function(e,t){return l.a.createElement("option",{value:e.val,key:t},e.text)}));return l.a.createElement(E.a,{className:"justify-content-md-center mt-2 mb-2"},l.a.createElement(g.a,{md:"5"},l.a.createElement(x.a,{as:"select",custom:!0,onChange:function(t){var a=e.options.filter((function(e){return e.val===t.target.value}))[0].text;e.setCounty({selected:t.target.value,selectedName:a}),e.setTownship({selected:"",selectedName:""})}.bind(void 0),value:e.county.selected},l.a.createElement("option",{value:"",disabled:!0},"---\u8acb\u9078\u64c7\u7e23\u5e02---"),t)))},j=a(38),O=a(11),y=a.n(O),N=function(e){var t=Object(n.useState)([]),a=Object(p.a)(t,2),c=a[0],r=a[1];Object(n.useEffect)((function(){e.county.selected&&y.a.get("https://api.nlsc.gov.tw/other/ListTown1/".concat(e.county.selected),(function(t){if(y()(t).find("townItem").length>0){var a=Object(j.a)(y()(t).find("townItem")).filter((function(e){return y()(e).find("towncode01").html()})).map((function(t){return y()(t).find("townname").html(y()(t).find("townname").html().replace(/(\u81fa\u7063|\u798f\u5efa)\u7701/,"")),{text:y()(t).find("townname").html().replace(e.county.selectedName,""),val:y()(t).find("townname").html().replace(e.county.selectedName,"")}}));r(a)}}))}),[e.county.selected,e.county.selectedName]);var o=c.map((function(e,t){return l.a.createElement("option",{value:e.val,key:t},e.text)}));return e.county.selected&&l.a.createElement(E.a,{className:"justify-content-md-center mb-2 mt-2"},l.a.createElement(g.a,{md:"5"},l.a.createElement(x.a,{as:"select",custom:!0,onChange:function(t){e.setTownship({selected:t.target.value,selectedName:t.target.value})}.bind(void 0),value:e.township.selected},l.a.createElement("option",{value:"",disabled:!0},"---\u8acb\u9078\u64c7\u9109\u93ae\u5e02\u5340---"),o)))},k=a(61),_=a.n(k),C=a(116),S=a(107),M=a(108),I=function(e){var t=Object(n.useState)([]),a=Object(p.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(""),i=Object(p.a)(o,2),s=i[0],u=i[1],m=Object(n.useState)(0),d=Object(p.a)(m,2),v=d[0],f=d[1],h=Object(n.useState)(0),b=Object(p.a)(h,2),E=b[0],g=b[1],x=Object(n.useState)(0),w=Object(p.a)(x,2),j=w[0],O=w[1],y=Object(n.useState)(!1),N=Object(p.a)(y,2),k=N[0],I=N[1];Object(n.useEffect)((function(){I(!0),_.a.get("https://3000.gov.tw/hpgapi-openmap/api/getPostData").then((function(t){for(var a=t.data.filter((function(t){return e.county.selected?t.hsnCd===e.county.selected:t})).filter((function(t){return e.township.selected?t.townNm===e.township.selected:t})),n=[],l=0,c=Math.floor(a.length/50);l<c;l++)n.push(a.slice(50*l,50*(l+1)));a.length%50&&n.push(a.slice(50*l,a.length)),u(a[0].updateTime),r(n),g(c),I(!1),O(0)}))}),[e.county.selected,e.township.selected]);var P;console.log(v,c),c.length&&(P=c[v].map((function(e,t){return l.a.createElement("tr",{key:t},l.a.createElement("td",null,t+1),l.a.createElement("td",null,e.hsnNm),l.a.createElement("td",null,e.storeNm),l.a.createElement("td",null,l.a.createElement("a",{href:"".concat("https://www.google.com.tw/maps/place/").concat(e.zipCd).concat(e.addr.replace(/\(.*\)/,""),"/@").concat(e.latitude,",").concat(e.longitude),title:"\u6253\u958b google \u5730\u5716",target:"_bland"},e.addr)),l.a.createElement("td",null,e.tel),l.a.createElement("td",null,e.busiTime.split("<br>").map((function(e,t){return l.a.createElement("div",{key:"busiT".concat(t)},e)}))),l.a.createElement("td",null,e.busiMemo.split("<br>").map((function(e,t){return l.a.createElement("div",{key:"busiM".concat(t)},e)}))),l.a.createElement("td",null,e.total))})));for(var T=function(e){e>0&&e<=E&&(f(e),O(e))},$=[],z=function(e){var t=e+1;j<3?t<j+4||t>E-4?$.push(l.a.createElement(C.a.Item,{key:t,active:t===j,onClick:function(){return T(t)}},t+1)):t===j+5&&$.push(l.a.createElement(C.a.Ellipsis,{key:"ellipsis-1"})):(t<2||t>j-2)&&(t<j+2||t>E-2)?$.push(l.a.createElement(C.a.Item,{key:t,active:t===j,onClick:function(){return T(t)}},t+1)):t===j-2?$.push(l.a.createElement(C.a.Ellipsis,{key:"ellipsis-1"})):t===j+2&&$.push(l.a.createElement(C.a.Ellipsis,{key:"ellipsis-2"}))},A=0;A<E;A++)z(A);var B=l.a.createElement("div",{className:"d-flex justify-content-center"},l.a.createElement(C.a,null,l.a.createElement(C.a.First,{onClick:function(){return T(1)},disabled:0===j}),l.a.createElement(C.a.Prev,{onClick:function(){return T(v-1)},disabled:0===j}),l.a.createElement(C.a.Item,{key:"0",active:0===j,onClick:function(){return T(0)}},"1"),$,l.a.createElement(C.a.Next,{onClick:function(){return T(v+1)},disabled:j===E}),l.a.createElement(C.a.Last,{onClick:function(){return T(E)},disabled:j===E})));return l.a.createElement("div",{className:"overflow-hidden"},l.a.createElement(S.a,{striped:!0,bordered:!0,hover:!0,className:"w-100"},l.a.createElement("caption",{className:"text-right"},"\u66f4\u65b0\u6642\u9593\uff1a",s),l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"#"),l.a.createElement("th",null,"\u7e23\u5e02\u540d\u7a31"),l.a.createElement("th",null,"\u5206\u5c40\u540d\u7a31"),l.a.createElement("th",null,"\u5730\u5740"),l.a.createElement("th",null,"\u96fb\u8a71"),l.a.createElement("th",null,"\u71df\u696d\u6642\u9593"),l.a.createElement("th",null,"\u71df\u696d\u5099\u8a3b"),l.a.createElement("th",null,"\u5b58\u91cf"))),l.a.createElement("tbody",null,P)),B,l.a.createElement(M.a,{animation:"border",role:"status",className:"position-absolute absolute-bottom "+(k?"visible":"invisible")},l.a.createElement("span",{className:"sr-only"},"Loading...")))},P=function(){var e=Object(n.useState)({selected:"",selectedName:""}),t=Object(p.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)({selected:"",selectedName:""}),o=Object(p.a)(r,2),i=o[0],s=o[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement(b.a,null,l.a.createElement(w,{options:[{text:"\u81fa\u5317\u5e02",val:"A"},{text:"\u81fa\u4e2d\u5e02",val:"B"},{text:"\u57fa\u9686\u5e02",val:"C"},{text:"\u81fa\u5357\u5e02",val:"D"},{text:"\u9ad8\u96c4\u5e02",val:"E"},{text:"\u65b0\u5317\u5e02",val:"F"},{text:"\u5b9c\u862d\u7e23",val:"G"},{text:"\u6843\u5712\u5e02",val:"H"},{text:"\u65b0\u7af9\u5e02",val:"O"},{text:"\u65b0\u7af9\u7e23",val:"J"},{text:"\u82d7\u6817\u7e23",val:"K"},{text:"\u5357\u6295\u7e23",val:"M"},{text:"\u5f70\u5316\u7e23",val:"N"},{text:"\u96f2\u6797\u7e23",val:"P"},{text:"\u5609\u7fa9\u5e02",val:"I"},{text:"\u5609\u7fa9\u7e23",val:"Q"},{text:"\u5c4f\u6771\u7e23",val:"T"},{text:"\u82b1\u84ee\u7e23",val:"U"},{text:"\u81fa\u6771\u7e23",val:"V"},{text:"\u6f8e\u6e56\u7e23",val:"X"},{text:"\u91d1\u9580\u7e23",val:"W"},{text:"\u9023\u6c5f\u7e23",val:"Z"}],county:a,setCounty:c,setTownship:s}),l.a.createElement(N,{county:a,township:i,setTownship:s}),l.a.createElement(I,{county:a,township:i})))},T=a(115),$=a(110),z=a(117),A=a(111),B=a(118),F=a(62),L=a(15),D=a(8),K=a.n(D),J=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"createLeafletElement",value:function(e){console.log("1");var t=[{color:"8d8",text:"\u6578\u91cf\u5145\u8db3"},{color:"fa0",text:"\u6578\u91cf\u5c11\u65bc\u4e00\u534a"},{color:"f00",text:"\u6578\u91cf\u6975\u5c11"},{color:"c0c0c0",text:"\u5df2\u9818\u5b8c\u6216\u672a\u53d7\u7406"}],a=K.a.control({position:"bottomright"});return a.onAdd=function(){var e=K.a.DomUtil.create("div","legend");return e.innerHTML=t.reduce((function(e,t){return"".concat(e,'\n        <div class="legend__lebel">\n          <i style="background: #').concat(t.color,'"></i>').concat(t.text,"\n        </div>  \n      ")}),""),e},a}}]),a}(F.a),U=Object(L.b)(J),W=(a(96),function(e){var t=Object(n.useState)([{text:"\u81fa\u5317\u5e02",val:"A"},{text:"\u81fa\u4e2d\u5e02",val:"B"},{text:"\u57fa\u9686\u5e02",val:"C"},{text:"\u81fa\u5357\u5e02",val:"D"},{text:"\u9ad8\u96c4\u5e02",val:"E"},{text:"\u65b0\u5317\u5e02",val:"F"},{text:"\u5b9c\u862d\u7e23",val:"G"},{text:"\u6843\u5712\u5e02",val:"H"},{text:"\u65b0\u7af9\u5e02",val:"O"},{text:"\u65b0\u7af9\u7e23",val:"J"},{text:"\u82d7\u6817\u7e23",val:"K"},{text:"\u5357\u6295\u7e23",val:"M"},{text:"\u5f70\u5316\u7e23",val:"N"},{text:"\u96f2\u6797\u7e23",val:"P"},{text:"\u5609\u7fa9\u5e02",val:"I"},{text:"\u5609\u7fa9\u7e23",val:"Q"},{text:"\u5c4f\u6771\u7e23",val:"T"},{text:"\u82b1\u84ee\u7e23",val:"U"},{text:"\u81fa\u6771\u7e23",val:"V"},{text:"\u6f8e\u6e56\u7e23",val:"X"},{text:"\u91d1\u9580\u7e23",val:"W"},{text:"\u9023\u6c5f\u7e23",val:"Z"}]),a=Object(p.a)(t,1)[0],c=Object(n.useState)([]),r=Object(p.a)(c,2),o=r[0],i=r[1],s=Object(n.useState)(""),u=Object(p.a)(s,2),m=u[0],d=u[1],v=Object(n.useState)(""),f=Object(p.a)(v,2),h=f[0],b=f[1],E=Object(n.useState)([]),g=Object(p.a)(E,2),x=g[0],w=g[1],O=Object(n.useState)(""),N=Object(p.a)(O,2),k=N[0],_=N[1],C=Object(n.useState)(!0),S=Object(p.a)(C,2),M=S[0],I=S[1],P=function(e){var t=a[a.findIndex((function(t){return t.val===e.target.value}))].text;d(e.target.value),function(e,t){y.a.get("https://api.nlsc.gov.tw/other/ListTown1/".concat(e),(function(e){if(y()(e).find("townItem").length>0){var a=Object(j.a)(y()(e).find("townItem")).filter((function(e){return y()(e).find("towncode01").html()})).map((function(e){return y()(e).find("townname").html().replace(new RegExp("(\u81fa\u7063\u7701|\u798f\u5efa\u7701)(".concat(t,")")),""),{text:y()(e).find("townname").html(),val:y()(e).find("townname").html()}}));i(a)}}))}(e.target.value,t),b("")},T=function(e,t){if(e.includes("\u672c\u65e5\u672a\u71df\u696d"))return"red";var a=t/(e=e.replace(/\u672c\u65e5\u53ef\u53d7\u7406\u91cf\uff1a(\w+)/,"$1"))*100;switch(!0){case a>80:return"green";case a>50:return"yellow";case a>0:return"orange";default:return"red"}};return Object(n.useEffect)((function(){w(e.listItems)}),[e.listItems]),Object(n.useEffect)((function(){var t;t=m&&""!==m?h&&""!==h?e.listItems.filter((function(e){return e.hsnCd===m&&e.townNm===h})):e.listItems.filter((function(e){return e.hsnCd===m})):e.listItems,w(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"storeNm";return e.length>0&&k?e.filter((function(e){return e[t].includes(k)})):e}(t))}),[m,h,k,e.listItems]),l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{className:"searchBtn ".concat(M?"show":""),onClick:function(){return I(!M),void e.setShow(!e.show)}},l.a.createElement("span",{role:"img","aria-label":"string"},"\ud83d\udd0d")),l.a.createElement("section",{className:"sidebar ".concat(M?"":"hide")},l.a.createElement("div",{className:"sidebar__container"},l.a.createElement("div",{className:"select__container"},l.a.createElement("select",{className:"select__item",value:m,onChange:function(e){return P(e)}},l.a.createElement("option",{value:""},"\u8acb\u9078\u64c7\u7e23\u5e02"),a.map((function(e){return l.a.createElement("option",{value:e.val,key:e.val},e.text)}))),l.a.createElement("select",{className:"select__item",value:h,onChange:function(e){return function(e){return b(e.target.value)}(e)}},l.a.createElement("option",{value:""},"\u8acb\u9078\u64c7\u9109\u93ae\u5e02\u5340"),o.map((function(e){return l.a.createElement("option",{value:e.val,key:e.val},e.text)}))),l.a.createElement("input",{className:"select__item",onKeyUp:function(e){return _(e.target.value)},placeholder:"\u8acb\u8f38\u5165\u6b32\u641c\u5c0b\u90f5\u5c40\u540d\u7a31"})),l.a.createElement("ul",{className:"list"},x.map((function(t){return l.a.createElement("li",{className:"list__card",key:t.storeNm},l.a.createElement("div",{className:"list__card__body"},t.hsnNm,l.a.createElement("br",null),l.a.createElement("h1",{className:"list__card__body__title"},t.storeNm),t.addr,l.a.createElement("br",null),t.busiMemo.replace(/.*(?:<br>|^)+\*(.*)<br>/,"$1"),l.a.createElement("br",null),"\u5269\u9918\u6578\u91cf\uff1a",l.a.createElement("span",{className:T(t.busiMemo.replace(/.*(?:<br>|^)+\*(.*)<br>/,"$1"),t.total)},t.total),l.a.createElement("br",null)),l.a.createElement("button",{onClick:function(){return a=t,void e.setPosition([a.latitude,a.longitude]);var a}},"\u524d\u5f80 ",String.fromCharCode(187),l.a.createElement("span",{className:"addr"}," ",t.storeNm," ")))}))))))}),H=function(e){var t='\n  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" class="marker">\n    <path stroke="#000000" fill="'.concat(e,'" d="M15.938 32S6 17.938 6 11.938C6 .125 15.938 0 15.938 0S26 .125 26 11.875C26 18.062 15.938 32 15.938 32zM16 6c-2.209 0-4 1.791-4 4s1.791 4 4 4 4-1.791 4-4-1.791-4-4-4z"/>\n  </svg>');return Object(D.divIcon)({className:"marker",html:t,iconSize:[40,40],iconAnchor:[12,24],popupAnchor:[7,-16]})},G=(a(97),a(98),{width:"100%",height:"100%"}),Q=function(){var e=Object(n.useState)(!0),t=Object(p.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)([22.627277,120.301437]),o=Object(p.a)(r,2),i=o[0],s=o[1],u=Object(n.useState)([]),m=Object(p.a)(u,2),d=m[0],v=m[1],f=Object(n.useState)(13),h=Object(p.a)(f,2),b=h[0],E=h[1];Object(n.useEffect)((function(){y.a.get("https://3000.gov.tw/hpgapi-openmap/api/getPostData",(function(e){v(e)})),navigator.geolocation&&navigator.geolocation.watchPosition((function(e){s([e.coords.latitude,e.coords.longitude])}))}),[]),Object(n.useEffect)((function(){E(18)}),[i]);var g=function(e,t){if(e){if((e=e.replace(/.*(?:<br>|^)+\*(.*)<br>/,"$1").replace(/\u672c\u65e5\u53ef\u53d7\u7406\u91cf\uff1a(\w+)/,"$1")).includes("\u672c\u65e5\u672a\u71df\u696d"))return"#c0c0c0";var a=t/e*100;switch(!0){case a>80:return"#8d8";case a>50:return"#fa0";case a>30:return"#f00";default:return"#c0c0c0"}}};return l.a.createElement(l.a.Fragment,null,l.a.createElement(W,{setShow:c,show:a,setPosition:s,listItems:d}),l.a.createElement("div",{className:"mainMap "+(a?"show":"")},l.a.createElement(T.a,{center:i,style:G,zoom:b,zoomControl:!1},l.a.createElement($.a,{position:"topright"}),l.a.createElement(z.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),l.a.createElement(U,null),l.a.createElement(A.a,{position:i,icon:H("#1CA0E9")},l.a.createElement(B.a,null,"\u73fe\u5728\u4f4d\u7f6e")),d.filter((function(e){return function(e,t,a,n){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"K";if(e===a&&t===n)return 0;var c=Math.PI*e/180,r=Math.PI*a/180,o=t-n,i=Math.PI*o/180,s=Math.sin(c)*Math.sin(r)+Math.cos(c)*Math.cos(r)*Math.cos(i);return s>1&&(s=1),s=60*(s=180*(s=Math.acos(s))/Math.PI)*1.1515,"K"===l&&(s*=1.609344),"N"===l&&(s*=.8684),s}(i[0],i[1],e.latitude,e.longitude)<2})).map((function(e){return l.a.createElement(A.a,{position:[e.latitude,e.longitude],icon:H(g(e.busiMemo,e.total)),key:e.storeNm},l.a.createElement(B.a,null,l.a.createElement("h1",{className:"list__card__body__title"},e.storeNm),e.addr,l.a.createElement("br",null),e.busiMemo.replace(/.*(?:<br>|^)+\*(.*)<br>/,"$1"),l.a.createElement("br",null),"\u5269\u9918\u6578\u91cf\uff1a",l.a.createElement("span",{className:g(e.busiMemo.replace(/.*(?:<br>|^)+\*(.*)<br>/,"$1"),e.total)},e.total)))})))))},V=(a(99),a(100),function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement(m.a,{basename:"3000-search"},l.a.createElement("div",{className:"App"},l.a.createElement(v.a,{bg:"dark",variant:"dark",expand:"lg"},l.a.createElement(v.a.Brand,{href:"#"},"\u632f\u8208\u5238\u90f5\u5c40\u5eab\u5b58\u901f\u67e5"),l.a.createElement(f.a,null,l.a.createElement(h.a,{as:m.b,className:"text-light",to:"/"},"\u8868\u683c"),l.a.createElement(h.a,{as:m.b,className:"text-light",to:"/map"},"\u5730\u5716"))),l.a.createElement(d.c,null,l.a.createElement(d.a,{exact:!0,path:"/"},l.a.createElement(P,null)),l.a.createElement(d.a,{path:"/map"},l.a.createElement(Q,null))),l.a.createElement("footer",{className:"bg-light position-fixed fixed-bottom"},"made by listennn08.")))}}]),a}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},69:function(e,t,a){e.exports=a(103)},74:function(e,t,a){},96:function(e,t,a){},98:function(e,t,a){},99:function(e,t,a){}},[[69,1,2]]]);
//# sourceMappingURL=main.eef1ed64.chunk.js.map